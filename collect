
#!/usr/bin/env bash

source .setup/helpers

## warn
printf "
This script is supposed to be executed only once in order to populate the dotfiles
repo from the available files across the current system. If you run it after the
files are symlinked, you're just copying dead symlinks over symlinks. That'd be
genocide, be warned.\n\n"
read -p "Press enter to continue..."


## collect non-symlinked dotfiles
./update


## privates
say 'Collecting privates...'

# todos
cp -vf ~/.todos.json private/conf

# hosts
cp -vf /etc/hosts private/etc

# shell
cp -vf ~/.zshrc.local private/conf/shell
cp -vf ~/.bashrc.local private/conf/shell
cp -vf ~/.profile.local private/conf/shell

# confs
cp -vf ~/.githubrc private/conf

# apps
cp -vf ~/.nylas-mail/config.json private/conf/app/nylas
cp -rf ~/Library/Application\ Support/Adium\ 2.0/Users private/conf/app/adium/Adium\ 2.0/Users

# personal content
cp -rf ~/Pictures/Icons private/var/pictures
cp -rf ~/Pictures/Memes private/var/pictures
cp -rf ~/Pictures/Identity private/var/pictures
cp -rf ~/Pictures/Wallpapers private/var/pictures
cp -rf ~/Pictures/Photo\ Booth\ Library private/var/pictures

# macos prefs
cp -rf ~/Library/Preferences private/conf/macos


## shell
say 'Collecting shell files...'
cp -vf ~/.{zshrc,profile,profile.helpers,aliases,bashrc,bash_profile} conf/shell/


## languages
say 'Collecting npm, gem, pip and composer configs, if any...'
cp -vf ~/.gemrc conf/
cp -vf ~/.npmrc conf/
cp -vf ~/.composer/composer.json cellar/


## git/ssh/gpg
say 'Collecting git, ssh and gpg configs...'
cp -vf ~/.ssh/config conf/ssh/config
cp -vf ~/.gnupg/gpg.conf conf/gnupg/gpg.conf
cp -vf ~/.{gitconfig,gitignore,gitignore_global,git_hooks} conf/git/


## misc
say 'Collecting misc configs...'
cp -vf ~/.translate-shell/init.trans conf/trans.init
cp -vf ~/.{ackrc,curlrc,axelrc,mongorc.js,editorconfig,ansible.cfg} conf/


## services
say 'Collecting service configs...'

# supervisor
cp -vf /usr/local/etc/supervisord.ini conf/service/supervisor
cp -vrf /usr/local/etc/supervisor.d conf/service/supervisor/supervisor.d

# apache httpd
cp -vf /usr/local/etc/apache2/2.4/httpd.conf conf/service/httpd24/
cp -vf /usr/local/etc/apache2/2.4/extra/httpd-vhosts.conf conf/service/httpd24/

# php
cp -rf /usr/local/etc/php/7.1/conf.d conf/service/php
cp -vf /usr/local/etc/php/7.1/{php.ini,php-fpm.conf} conf/service/php

# valet
cp -rf ~/.valet conf/service
mv conf/service/{.valet,valet}

# nginx
cp -vf /usr/local/etc/nginx/nginx.conf conf/service/nginx
cp -rf /usr/local/etc/nginx/{valet,servers} conf/service/nginx

## apps
say 'Collecting app configs...'

# intellij repo
git submodule add https://github.com/sepehr/intellij-settings.git conf/app/intellij

# vim
mkdir -p conf/app/vim/.vim
cp -vf ~/.{vimrc,gvimrc} conf/app/vim/
cp -rf ~/.vim/{autoload,colors} conf/app/vim/.vim

# sublime
cp -rf ~/Library/Application\ Support/Sublime\ Text\ 3/Packages/User/{Schemes,Snippets,Preferences.sublime-settings,Default\ \(OSX\).sublime-keymap,Package\ Control.sublime-settings} conf/app/sublime

# atom
cp -vf ~/.atom/{config.cson,keymap.cson,snippets.cson,init.coffee,styles.less} conf/app/atom

# chrome's stylish
cp -vrf ~/Library/Application\ Support/Google/Chrome/Profile\ 2/IndexedDB/chrome-extension_fjnbnpbmkenffdnngjfgmeleoegfcffe_0.indexeddb.leveldb/* conf/app/chrome/stylish.leveldb

# adium
cp -rf ~/Library/Application\ Support/Adium\ 2.0/Sounds conf/app/adium/Adium\ 2.0
cp -rf ~/Library/Application\ Support/Adium\ 2.0/Scripts conf/app/adium/Adium\ 2.0
cp -rf ~/Library/Application\ Support/Adium\ 2.0/Plugins conf/app/adium/Adium\ 2.0
cp -rf ~/Library/Application\ Support/Adium\ 2.0/Emoticons conf/app/adium/Adium\ 2.0
cp -rf ~/Library/Application\ Support/Adium\ 2.0/Dock\ Icons conf/app/adium/Adium\ 2.0
cp -rf ~/Library/Application\ Support/Adium\ 2.0/Status\ Icons conf/app/adium/Adium\ 2.0
cp -rf ~/Library/Application\ Support/Adium\ 2.0/Contact\ List conf/app/adium/Adium\ 2.0
cp -rf ~/Library/Application\ Support/Adium\ 2.0/Service\ Icons conf/app/adium/Adium\ 2.0
cp -rf ~/Library/Application\ Support/Adium\ 2.0/Menu\ Bar\ Icons conf/app/adium/Adium\ 2.0
cp -rf ~/Library/Application\ Support/Adium\ 2.0/Message\ Styles conf/app/adium/Adium\ 2.0

# dash
cp -vf ~/Dropbox/dev/dash/Snippets.dash conf/app/dash/snippets.dash
cp -vf ~/Library/Application\ Support/Dash/library.dash conf/app/dash

# littlesnitch
cp -vf ~/Library/Application\ Support/Little\ Snitch/configuration.user.xpl conf/app/littlesnitch

# transmission
cp -vrf ~/Library/Application\ Support/Transmission/blocklists conf/app/transmission

# apptivate
cp -vf ~/Library/Application\ Support/Apptivate/hotkeys conf/app/apptivate

# cerebro
cp -rf ~/Library/Application\ Support/Cerebro conf/app
mv conf/app/{Cerebro,cerebro}
